#!/bin/sh

echo "ðŸ¡ Making yourself at home..."

if [[ $(command -v brew) == "" ]]; then
  echo "ðŸº Installing Hombrew"
  sh -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)" > /dev/null 2>&1
else
  echo "ðŸº Updating Homebrew"
  brew update > /dev/null 2>&1
fi

echo "ðŸ“¦ Installing zsh"
brew install zsh > /dev/null 2>&1

echo "ðŸ’¾ Setting zsh as the default shell"
chsh -s $(which zsh) > /dev/null 2>&1

echo "ðŸ“¦ Installing chezmoi"
brew install chezmoi > /dev/null 2>&1

echo "ðŸ¡ Initializing chezmoi"
chezmoi init benvilliere > /dev/null 2>&1

echo "ðŸ¡ Applying chezmoi"
chezmoi apply

echo "ðŸ“¦ Installing Homebrew Packages"
brew bundle --file "${HOME}/.dotfiles/brew/Brewfile" > /dev/null 2>&1

echo "ðŸ’¾ Updating ~/.zshrc file"
zshrc_directive='source "${HOME}/.dotfile"'
if ! grep -Fxq "${zshrc_directive}" "${HOME}/.zshrc"; then
  echo "${zshrc_directive}" >> "${HOME}/.zshrc"
fi

echo "ðŸ’¾ Sourcing ~/.zshrc file"
zsh "${HOME}/.zshrc"

echo "âœ… Done."
exec zsh
